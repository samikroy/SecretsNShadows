// Detect AI tool usage via browser processes and network events
DeviceProcessEvents
| where FileName in~ ("chrome.exe", "msedge.exe", "firefox.exe")
| where ProcessCommandLine has_any ("chat.openai.com", "bard.google.com", "claude.ai", "notion.so", "gemini.google.com", "poe.com", "jasper.ai")
| project Timestamp, DeviceName, InitiatingProcessAccountName, FileName, ProcessCommandLine

// Extend to capture network calls to AI domains
union (
    DeviceNetworkEvents
    | where RemoteUrl has_any ("openai.com", "bard.google.com", "anthropic.com", "poe.com", "notion.so")
    | project Timestamp, DeviceName, InitiatingProcessAccountName, RemoteUrl, InitiatingProcessFileName
)
